<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Plan - Investimento Monolocale Milano</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        @media print {
            body { 
                background: white !important; 
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            .container { max-width: none !important; margin: 0 !important; padding: 20px !important; }
            .grid { display: block !important; }
            .lg\\:grid-cols-2 > div { margin-bottom: 20px !important; }
            .shadow-lg { box-shadow: none !important; border: 1px solid #e5e7eb !important; }
            .bg-gradient-to-br { background: white !important; }
            .rounded-xl, .rounded-lg { border-radius: 8px !important; }
            .text-blue-600, .text-green-600, .text-red-600, .text-yellow-600, .text-orange-600 { 
                color: #1f2937 !important; font-weight: bold !important; 
            }
            .bg-blue-50, .bg-green-50, .bg-red-50, .bg-yellow-50, .bg-orange-50, .bg-gray-50 { 
                background: #f9fafb !important; border: 1px solid #e5e7eb !important; 
            }
            h1, h2, h3 { color: #1f2937 !important; }
            .page-break { page-break-before: always; }
        }
        
        .print-only { display: none; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Print Header -->
        <div class="print-only text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2" id="printTitle">Business Plan Immobiliare</h1>
            <p class="text-lg text-gray-600" id="printSubtitle">Analisi di fattibilit√† - Investimento Immobiliare</p>
            <p class="text-sm text-gray-500 mt-2" id="printDate"></p>
        </div>

        <!-- Header -->
        <div class="text-center mb-8 no-print">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Business Plan Immobiliare</h1>
            <p class="text-lg text-gray-600">Analisi di fattibilit√† - Investimento Immobiliare</p>
            
            <!-- Scenario Tabs -->
            <div class="flex justify-center mt-6 space-x-4 no-print">
                <button onclick="loadScenario('milan-airbnb')" id="tab-milan-airbnb" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition duration-200">
                    üè† Affitti Brevi Milano
                </button>
                <button onclick="loadScenario('catania-airbnb')" id="tab-catania-airbnb" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition duration-200">
                    üåä Affitti Brevi Catania
                </button>
                <button onclick="loadScenario('milan-residence')" id="tab-milan-residence" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition duration-200">
                    üè° Affitto Tradizionale Milano
                </button>
            </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Input Section -->
            <div class="bg-white rounded-xl shadow-lg p-6 no-print">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm mr-3">1</span>
                    Dati dell'Investimento
                </h2>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Prezzo di Acquisto (‚Ç¨)</label>
                        <input type="number" id="purchasePrice" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 120000" value="120000">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Capitale Proprio (‚Ç¨)</label>
                            <input type="number" id="ownCapital" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 35000" value="35000">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Importo Mutuo (‚Ç¨)</label>
                            <input type="number" id="mortgageAmount" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 85000" value="85000">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Rata Mutuo Mensile (‚Ç¨)</label>
                        <input type="number" id="mortgagePayment" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 550" value="550">
                    </div>

                    <!-- Traditional Rental Section -->
                    <div class="bg-purple-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <span class="mr-2">üìã</span>
                            Affitto Tradizionale
                        </h3>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Affitto Mensile Base (‚Ç¨)</label>
                            <input type="number" id="monthlyRent" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="es. 900" value="900">
                        </div>
                        
                        <div class="mt-4">
                            <h4 class="font-medium text-gray-700 mb-3">Modalit√† Pagamento Spese</h4>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="radio" name="expensePayment" value="forfeit" class="mr-2" checked>
                                    <span class="text-sm">üí∞ Forfettario (non soggetto a IRPEF)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="expensePayment" value="separate" class="mr-2">
                                    <span class="text-sm">üìä Separato (soggetto a IRPEF)</span>
                                </label>
                            </div>
                        </div>

                        <div id="forfeitInputs" class="mt-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Forfait Condominio (‚Ç¨/mese)</label>
                                    <input type="number" id="condoForfeit" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="es. 120" value="120">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Forfait Utenze (‚Ç¨/mese)</label>
                                    <input type="number" id="utilitiesForfeit" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="es. 80" value="80">
                                </div>
                            </div>
                            <div class="bg-green-100 p-3 rounded-lg mt-3">
                                <p class="text-xs text-green-800">üí° <strong>Vantaggio fiscale:</strong> I forfait non sono soggetti a tassazione IRPEF. Solo l'affitto base (‚Ç¨<span id="baseRentDisplay">900</span>/mese) sar√† tassato con cedolare secca al 21%.</p>
                            </div>
                        </div>

                        <div id="separateInputs" class="mt-4" style="display: none;">
                            <div class="bg-orange-100 p-3 rounded-lg">
                                <p class="text-sm text-orange-800 mb-2">‚ö†Ô∏è <strong>Pagamento separato:</strong></p>
                                <div class="text-xs text-orange-700">
                                    <p>‚Ä¢ L'inquilino paga direttamente condominio e utenze</p>
                                    <p>‚Ä¢ Solo l'affitto base viene incassato dal proprietario</p>
                                    <p>‚Ä¢ Tutto l'importo √® soggetto a cedolare secca al 21%</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Short-term Rental Section -->
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <span class="mr-2">üè®</span>
                            Affitti Brevi (Airbnb)
                        </h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tariffa Notte (‚Ç¨)</label>
                                <input type="number" id="nightlyRate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="es. 65" value="65">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Occupazione (%)</label>
                                <input type="number" id="occupancyRate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="es. 70" value="70" min="0" max="100">
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Costo Pulizie per Soggiorno (‚Ç¨)</label>
                            <input type="number" id="cleaningCost" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="es. 25" value="25">
                        </div>
                        <div class="bg-blue-100 p-3 rounded-lg mt-3">
                            <p class="text-xs text-blue-800">üìä <strong>Calcolo automatico:</strong> <span id="nightsDisplay">255</span> notti/anno √ó ‚Ç¨<span id="rateDisplay">65</span> = ‚Ç¨<span id="grossIncomeDisplay">16.575</span> lordi</p>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Spese Condominiali Mensili (‚Ç¨)</label>
                        <input type="number" id="condoFees" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 120" value="120">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Utenze Mensili (‚Ç¨)</label>
                        <input type="number" id="utilities" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 80" value="80">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IMU Annuale - Prima Casa (‚Ç¨)</label>
                            <input type="number" id="imuFirstHome" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 0" value="0">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IMU Annuale - Seconda Casa (‚Ç¨)</label>
                            <input type="number" id="imuSecondHome" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 1800" value="1800">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">TARI Annuale (‚Ç¨)</label>
                        <input type="number" id="tari" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 180" value="180">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Manutenzioni Annuali (‚Ç¨)</label>
                        <input type="number" id="maintenance" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="es. 1200" value="1200">
                    </div>

                    <div class="bg-orange-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-3">Altri Costi</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Assicurazione Casa (‚Ç¨/anno)</label>
                                <input type="number" id="insurance" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="es. 300" value="300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Amministratore (‚Ç¨/anno)</label>
                                <input type="number" id="administrator" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="es. 200" value="200">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Commissioni Airbnb (%)</label>
                                <input type="number" id="airbnbCommission" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="es. 3" value="3" step="0.1">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Cedolare Secca (%)</label>
                                <input type="number" id="taxRate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="es. 21" value="21" step="0.1">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Imposta di Soggiorno (‚Ç¨/notte)</label>
                                <input type="number" id="cityTax" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="es. 3" value="3" step="0.1">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Spese Varie/Imprevisti (‚Ç¨/anno)</label>
                                <input type="number" id="miscExpenses" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="es. 500" value="500">
                            </div>
                        </div>
                    </div>

                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-3">üè† Agevolazione Prima Casa (2028-2032)</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">RAL Attuale (‚Ç¨)</label>
                                <input type="number" id="currentSalary" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="es. 47000" value="47000">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Aumento Annuale (%)</label>
                                <input type="number" id="salaryIncrease" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="es. 2.5" value="2.5" step="0.1">
                            </div>
                        </div>
                        <p class="text-xs text-gray-600 mt-2">Tassazione ridotta al 50% della RAL per 5 anni dal 2028</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <button onclick="calculateROI()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                            Calcola Fattibilit√†
                        </button>
                        <button onclick="printReport()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center">
                            üñ®Ô∏è Stampa Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    <span class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm mr-3">2</span>
                    Analisi Finanziaria
                </h2>

                <div id="results" class="space-y-6">
                    <!-- Investment Summary -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="font-semibold text-gray-800 mb-3">Capitale Proprio Investito</h3>
                        <div class="text-2xl font-bold text-blue-600" id="totalInvestment">‚Ç¨ 35.000</div>
                        <p class="text-sm text-gray-600 mt-1">Escluso mutuo di <span id="mortgageDisplay">‚Ç¨ 85.000</span></p>
                    </div>

                    <!-- Annual Income -->
                    <div class="bg-green-50 rounded-lg p-4">
                        <h3 class="font-semibold text
                          
